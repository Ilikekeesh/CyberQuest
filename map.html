<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Map</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="transition.css">

    <style>

        #map-container {
            position: relative;
            width: 100vw;
            height: 90vh;
        }

        #mySVG {
            width: 100%;
            height: 100%;
        }

        /* Style the map features */
        .map-line {
            stroke: #fff;
            stroke-width: 2;
            fill: none;
        }

        .map-point {
            fill: #93f4e0;
            cursor: pointer;
        }
        
        /* Style for the div you want to place on top */
        #overlay-div {
            position: absolute;
            top: 10%;
            left: 50%; 
            transform: translateX(-50%);
            padding: 20px;
            background-color: #690462;
            border: 2px solid #000;
            border-radius: 8px;
            z-index: 11; /* Make sure it is on top of the SVG */
            display: none; /* Initially hidden */
        }


    </style>

    <header>
        <nav>
            <div class="logo-top-left">
            <img src="whitelogo.png" alt="CyberQuest Logo" class="logo" style="width: 80px; height: 80px; margin-top: 17px;"/>
            </div>
            <ul>
                <li><a href="about.html" class="navlink">About</a></li>
                <li><a href="#">Map</a></li>
                <li><a href="classroom.html" class="navlink">Classroom</a></li>
                <li><a href="shop.html" class="navlink">Shop</a></li>
                <li><a href="login.html" class="navlink">Login</a></li>
            </ul>
        </nav>
    </header>

    <div class="transition transition-1 is-active">
        <img src="Drawing-1.sketchpad.png" alt="CyberQuest" id="loading"></div>
    </div>


</head>
<body>
<aside>
<div id="map-container">
    <svg id="mySVG" viewBox="0 0 300 150" preserveAspectRatio="xMidYMid meet"></svg>

    <div id="overlay-div">
        <h2>Level <div id="level" style="display: inline-block;"></div></h2>
        <p>Lorem ipsum dolor sit amet.</p>
        <button style="float: right;" onclick="document.getElementById('overlay-div').style.display = 'none';">Close</button>
        <button id="gobutton">Go!</button>
    </div>
</div>

<script>
    const svg = document.getElementById("mySVG");

    // Original points based on a 300x150 'viewBox'
    const points = [
        [200, 70], [205, 132], [99, 126], [100, 70], [185, 66],
        [180, 50], [170, 30], [150, 20], [128, 35], [115, 55]
    ];

    // 1. Convert points array to a 'path' string for the polyline
    // M = MoveTo (start point), L = LineTo (subsequent points)
    const polylinePath = points.map((p, i) => {
        return (i === 0 ? 'M' : 'L') + p[0] + ',' + p[1];
    }).join(' ');

    // 2. Create the line element (the map boundary)
    const line = document.createElementNS("http://www.w3.org/2000/svg", "path");
    line.setAttribute("d", polylinePath);
    line.setAttribute("class", "map-line");
    svg.appendChild(line);

    // 3. Create the circles (the map points)
    points.forEach((p, index) => {
        const circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
        circle.setAttribute("cx", p[0]);
        circle.setAttribute("cy", p[1]);
        circle.setAttribute("r", 4); // Radius
        circle.setAttribute("data-index", index+1);
        circle.setAttribute("class", "map-point");
        // Add click behavior to the points
        circle.addEventListener('click', function() {
            // Find the point on the screen (for positioning an *external* div)
            // For a simple demo, just show the pre-positioned div
            const overlayDiv = document.getElementById('overlay-div');
            overlayDiv.style.display = 'block';
            console.log(`Clicked point at original coords: (${p[0]}, ${p[1]})`);
            console.log(circle.getAttribute("data-index"));
            document.getElementById("level").innerHTML=circle.getAttribute("data-index");
            const gob = document.getElementById("gobutton");
            gob.addEventListener("click",function(){go(circle.getAttribute("data-index"))});
        });
        svg.appendChild(circle);
    });

    // NOTE: The SVG's 'viewBox="0 0 300 150"' and 'preserveAspectRatio' 
    // handle the proportional scaling automatically without needing JavaScript math.
    // The CSS on #map-container handles the 90% viewport height.

    // No need for a complex resize handler, as SVG handles resizing natively!
    function go(ind){
        console.log(ind);
        location.href='1'+ind+'.html';
    }
</script>
</aside>
    
    <footer>
        Team Phishify
    </footer>

    <script src="transition.js"></script>
</body>
</html>
